import { createFrontendPlugin, rpcApiRef, type ApiRef } from "@checkstack/frontend-api";
import { {{pluginNameCamel}}ApiRef, type {{pluginNamePascal}}ApiClient } from "./api";
import { {{pluginNamePascal}}ListPage } from "./components/{{pluginNamePascal}}ListPage";
import { {{pluginNameCamel}}Routes, {{pluginNamePascal}}Api, pluginMetadata, {{pluginNameCamel}}Access } from "@checkstack/{{pluginBaseName}}-common";

export default createFrontendPlugin({
  metadata: pluginMetadata,

  // Register routes using typed route definitions
  routes: [
    {
      route: {{pluginNameCamel}}Routes.routes.home,
      element: <{{pluginNamePascal}}ListPage />,
      title: "{{pluginNamePascal}}",
      accessRule: {{pluginNameCamel}}Access.read,
    },
  ],

  // Register client API using oRPC
  apis: [
    {
      ref: {{pluginNameCamel}}ApiRef,
      factory: (deps: { get: <T>(ref: ApiRef<T>) => T }): {{pluginNamePascal}}ApiClient => {
        const rpcApi = deps.get(rpcApiRef);
        // Create type-safe client using the plugin's Api definition
        return rpcApi.forPlugin({{pluginNamePascal}}Api);
      },
    },
  ],
});

export * from "./api";
