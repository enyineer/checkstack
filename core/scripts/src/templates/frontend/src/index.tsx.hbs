import { createFrontendPlugin, rpcApiRef, type ApiRef } from "@checkmate/frontend-api";
import { {{pluginNameCamel}}ApiRef, type {{pluginNamePascal}}ApiClient } from "./api";
import { {{pluginNamePascal}}ListPage } from "./components/{{pluginNamePascal}}ListPage";
import { {{pluginNameCamel}}Routes, {{pluginNamePascal}}Api } from "@checkmate/{{pluginBaseName}}-common";
import { ListIcon } from "lucide-react";

export default createFrontendPlugin({
  name: "{{pluginId}}",

  // Register routes using typed route definitions
  routes: [
    {
      route: {{pluginNameCamel}}Routes.routes.home,
      element: <{{pluginNamePascal}}ListPage />,
      title: "{{pluginNamePascal}}",
      permission: "{{pluginBaseName}}.read",
    },
  ],

  // Register client API using oRPC
  apis: [
    {
      ref: {{pluginNameCamel}}ApiRef,
      factory: (deps: { get: <T>(ref: ApiRef<T>) => T }): {{pluginNamePascal}}ApiClient => {
        const rpcApi = deps.get(rpcApiRef);
        // Create type-safe client using the plugin's Api definition
        return rpcApi.forPlugin({{pluginNamePascal}}Api);
      },
    },
  ],

  // Register navigation items
  navItems: [
    {
      title: "{{pluginNamePascal}}",
      route: {{pluginNameCamel}}Routes.routes.home,
      icon: <ListIcon />,
    },
  ],
});

export * from "./api";
